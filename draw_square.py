from PIL import Image, ImageDraw

class Error(Exception):
    """Default Error class."""
    pass

class LengthError(Error):
    """Default calss for Length Errors."""
    pass

def generate_image(data, path:str, scale_factor:int=20) -> None:

    if len(data) != 21:
        raise LengthError(f'Data length is {len(data)}, should be 21*21.')
    

    
    size = (21 * scale_factor, 21 * scale_factor) 
    size_back = (27 * scale_factor, 27 * scale_factor)
    
    img = Image.new(mode="RGB", size=size, color=(256, 256, 256))
    background = Image.new(mode="RGB", size=size_back, color=(256, 256, 256))
    draw = ImageDraw.Draw(img) 
    
    loc_v, loc_h = 0, 0 
    for i in data:
        for j in i:
            if str(int(j)) == '1': 
                draw.rectangle([(loc_h, loc_v), (loc_h + scale_factor, loc_v + scale_factor)], fill=(0, 0, 0)) 

            loc_h += scale_factor
            loc_h %= 420
        

        loc_v += scale_factor
    
    background.paste(img, (60, 60))
    background.save(path, 'JPEG') 


if __name__ == '__main__':
    '''qr = [[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1, 0.0, 1, 0.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0], [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1, 1.0, 0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0], [1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1, 0.0, 1, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0], [1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0, 1.0, 0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0], [1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1, 1.0, 1, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0], [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1, 1.0, 1, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0], [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0, 0.0, 0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0, 0.0, 1, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 1, 1.0, 1, 1.0, 0, 0.0, 0, 1.0, 0, 0.0, 1, 0.0, 0, 0.0, 0, 1.0, 0, 0.0, 0, 1.0], [0, 0.0, 0, 1.0, 1, 1.0, 1.0, 1.0, 1, 1.0, 0, 1.0, 0, 0.0, 1, 0.0, 1, 1.0, 0, 0.0, 0], [1.0, 1, 1.0, 1, 0.0, 1, 0.0, 1, 1.0, 0, 0.0, 1, 1.0, 1, 0.0, 1, 0.0, 1, 1.0, 1, 0.0], [0, 1.0, 0, 0.0, 1, 1.0, 1.0, 1.0, 0, 1.0, 0, 1.0, 0, 0.0, 1, 1.0, 1, 0.0, 1, 0.0, 1], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0, 1.0, 0, 0.0, 0, 1.0, 0, 0.0, 0, 1.0, 0, 1.0], [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0, 0.0, 1, 0.0, 0, 1.0, 0, 1.0, 1, 0.0, 0], [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1, 1.0, 0, 0.0, 0, 1.0, 1, 0.0, 1, 0.0, 0, 0.0], [1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0, 0.0, 1, 0.0, 1, 1.0, 1, 1.0, 1, 1.0, 1], [1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0, 1.0, 1, 0.0, 1, 0.0, 1, 0.0, 0, 0.0, 1, 0.0], [1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 0.0, 0.0, 1.0, 1, 1.0, 0, 1.0, 1, 1.0, 0, 1.0, 0, 0.0, 1], [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0, 0.0, 1, 1.0, 1, 0.0, 0, 0.0, 1, 0.0, 1, 1.0], [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0, 1.0, 0, 1.0, 1, 1.0, 0, 0.0, 0, 0.0, 1]]
    generate_image(qr, 'xd')'''
    